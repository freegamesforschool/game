<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Dodge!</title>
<style>
  body { margin:0; overflow:hidden; background:#111; }
  canvas { display:block; }
  #score {
    position:fixed; top:10px; left:10px;
    color:white; font-family:sans-serif; font-size:20px;
  }
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="score">Score: 0</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; }
resize(); addEventListener("resize", resize);

let player = { x: innerWidth/2, y: innerHeight-80, w:50, h:50, speed:7 };
let keys = {};
let objects = [];
let score = 0;
let spawnTimer = 0;

addEventListener("keydown", e => keys[e.key] = true);
addEventListener("keyup", e => keys[e.key] = false);

function spawnObject(){
  objects.push({
    x: Math.random()*canvas.width,
    y: -40,
    size: 30 + Math.random()*20,
    speed: 3 + Math.random()*4
  });
}

function update(){
  if(keys["ArrowLeft"] || keys["a"]) player.x -= player.speed;
  if(keys["ArrowRight"] || keys["d"]) player.x += player.speed;

  player.x = Math.max(0, Math.min(canvas.width-player.w, player.x));

  spawnTimer++;
  if(spawnTimer > 25){
    spawnTimer = 0;
    spawnObject();
  }

  for(let o of objects){
    o.y += o.speed;
    if(o.y > canvas.height){
      score++;
      document.getElementById("score").textContent = "Score: " + score;
      objects.splice(objects.indexOf(o),1);
    }

    if(o.x < player.x+player.w &&
       o.x+o.size > player.x &&
       o.y < player.y+player.h &&
       o.y+o.size > player.y){
      alert("Game Over! Final Score: " + score);
      location.reload();
    }
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle = "#4af";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  ctx.fillStyle = "#f44";
  for(let o of objects){
    ctx.fillRect(o.x, o.y, o.size, o.size);
  }
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
